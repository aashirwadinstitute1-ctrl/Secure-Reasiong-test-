<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Secure Online Exam</title>
  <style>
    body { font-family: Arial, sans-serif; background:#f5f5f5; margin:0; padding:0; }
    header { background:#2563eb; color:white; padding:15px; text-align:center; font-size:24px; font-weight:bold; }
    #timer { font-size:18px; text-align:right; padding:10px; margin-right:20px; color:#e63946; }
    #question-container { margin:20px auto; padding:20px; width:80%; background:white; border-radius:10px; box-shadow:0 0 10px rgba(0,0,0,0.1); }
    .question { font-size:20px; margin-bottom:15px; }
    .options label { display:block; margin-bottom:8px; cursor:pointer; }
    #controls { text-align:center; margin:20px; }
    #controls button { background:#2563eb; color:#fff; border:none; padding:10px 16px; margin:5px; border-radius:6px; cursor:pointer; }
    #submitBtn { background:#16a34a; color:#fff; border:none; padding:12px 20px; border-radius:8px; display:block; margin:20px auto; cursor:pointer; }
    #result { text-align:center; font-size:22px; margin:20px; font-weight:bold; color:#2563eb; }
    img.question-img { display:block; margin:10px auto; max-width:250px; }
  </style>
</head>
<body>
  <header>Secure Online Exam</header>
  <div id="timer">Time Left: 40:00</div>

  <div id="question-container">
    <div id="question" class="question"></div>
    <img id="qImage" class="question-img" style="display:none;" />
    <div id="options" class="options"></div>
    <div id="controls">
      <button id="prevBtn" onclick="prevQuestion()">Previous</button>
      <button id="nextBtn" onclick="nextQuestion()">Next</button>
    </div>
  </div>

  <button id="submitBtn" onclick="submitExam()">Submit Exam</button>
  <div id="result"></div>

  <script src="questions.js"></script>
  <script>
    let currentQuestion = 0;
    let answers = {};

    function loadQuestion(index) {
      const q = questions[index];
      document.getElementById("question").innerText = q.q;

      // show image if exists
      const imgEl = document.getElementById("qImage");
      if (q.img) {
        imgEl.src = q.img;
        imgEl.style.display = "block";
      } else {
        imgEl.style.display = "none";
      }

      // options
      const optionsDiv = document.getElementById("options");
      optionsDiv.innerHTML = "";
      q.options.forEach(opt => {
        const checked = answers[index] === opt ? "checked" : "";
        optionsDiv.innerHTML += `
          <label>
            <input type="radio" name="q${index}" value="${opt}" ${checked} onclick="answers[${index}]='${opt}'"> ${opt}
          </label>
        `;
      });

      // buttons enable/disable
      document.getElementById("prevBtn").disabled = index === 0;
      document.getElementById("nextBtn").disabled = index === questions.length - 1;
    }

    function nextQuestion() {
      if (currentQuestion < questions.length - 1) {
        currentQuestion++;
        loadQuestion(currentQuestion);
      }
    }

    function prevQuestion() {
      if (currentQuestion > 0) {
        currentQuestion--;
        loadQuestion(currentQuestion);
      }
    }

    function submitExam() {
      let score = 0;
      questions.forEach((q, i) => {
        if (answers[i] === q.correct) score++;
      });

      document.getElementById("question-container").style.display = "none";
      document.getElementById("submitBtn").style.display = "none";
      document.getElementById("result").innerText =
        `âœ… Exam Completed! Your Score: ${score} / ${questions.length}`;
    }

    // Timer 40 minutes
    let timeLeft = 40 * 60;
    function updateTimer() {
      let minutes = Math.floor(timeLeft / 60);
      let seconds = timeLeft % 60;
      document.getElementById("timer").innerText =
        `Time Left: ${minutes}:${seconds < 10 ? "0" : ""}${seconds}`;
      if (timeLeft <= 0) {
        submitExam();
      } else {
        timeLeft--;
        setTimeout(updateTimer, 1000);
      }
    }

    // init
    loadQuestion(currentQuestion);
    updateTimer();
  </script>
</body>
</html>

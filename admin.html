<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Panel</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    h2, h3 { color: #2c3e50; }
    table { border-collapse: collapse; width: 100%; margin-top: 10px; }
    table, th, td { border: 1px solid #ddd; }
    th, td { padding: 8px; text-align: center; }
    th { background: #f4f4f4; }
    input, select, button { margin: 5px; padding: 6px; }
    button { cursor: pointer; }
    .logout { background: red; color: white; border: none; padding: 8px 12px; border-radius: 4px; }
  </style>
</head>
<body>
  <h2>Admin Panel</h2>
  <button class="logout" onclick="logout()">Logout</button>

  <!-- Student Records Section -->
  <h3>Student Records</h3>
  <div>
    <input type="text" id="studentName" placeholder="Name">
    <input type="text" id="studentId" placeholder="ID">
    <input type="text" id="studentMobile" placeholder="Mobile">
    <input type="file" id="studentPhoto">
    <button onclick="addStudent()">Add Student</button>
  </div>

  <table id="studentTable">
    <tr>
      <th>Photo</th>
      <th>Name</th>
      <th>ID</th>
      <th>Mobile</th>
      <th>Result</th>
      <th>Action</th>
    </tr>
  </table>

  <!-- Questions Management Section -->
  <h3>Questions Management</h3>
  <div>
    <input type="text" id="questionInput" placeholder="Enter Question" />
    <input type="text" id="option1" placeholder="Option 1" />
    <input type="text" id="option2" placeholder="Option 2" />
    <input type="text" id="option3" placeholder="Option 3" />
    <input type="text" id="option4" placeholder="Option 4" />
    <select id="correctAnswer">
      <option value="1">Option 1</option>
      <option value="2">Option 2</option>
      <option value="3">Option 3</option>
      <option value="4">Option 4</option>
    </select>
    <button onclick="addQuestion()">Add Question</button>
  </div>

  <table id="questionsTable">
    <tr>
      <th>Question</th>
      <th>Options</th>
      <th>Correct Answer</th>
      <th>Action</th>
    </tr>
  </table>

  <script>
    // -------- Student Management --------
    function loadStudents() {
      let students = JSON.parse(localStorage.getItem("students")) || [];
      const table = document.getElementById("studentTable");
      table.innerHTML = `
        <tr>
          <th>Photo</th>
          <th>Name</th>
          <th>ID</th>
          <th>Mobile</th>
          <th>Result</th>
          <th>Action</th>
        </tr>`;
      students.forEach((s, index) => {
        let row = table.insertRow();
        row.insertCell(0).innerHTML = `<img src="${s.photo}" width="50" height="50">`;
        row.insertCell(1).innerText = s.name;
        row.insertCell(2).innerText = s.id;
        row.insertCell(3).innerText = s.mobile;
        row.insertCell(4).innerText = s.result || "Not Uploaded";
        let actions = row.insertCell(5);
        actions.innerHTML = `
          <button onclick="uploadResult(${index})">Upload Result</button>
          <button onclick="deleteStudent(${index})">Delete</button>`;
      });
    }

    function addStudent() {
      const name = document.getElementById("studentName").value;
      const id = document.getElementById("studentId").value;
      const mobile = document.getElementById("studentMobile").value;
      const photoInput = document.getElementById("studentPhoto");

      if (!name || !id || !mobile || !photoInput.files[0]) {
        alert("Please fill all fields");
        return;
      }

      const reader = new FileReader();
      reader.onload = function (e) {
        let students = JSON.parse(localStorage.getItem("students")) || [];
        students.push({
          name,
          id,
          mobile,
          photo: e.target.result,
          result: "Not Uploaded",
        });
        localStorage.setItem("students", JSON.stringify(students));
        loadStudents();
      };
      reader.readAsDataURL(photoInput.files[0]);

      // clear input fields
      document.getElementById("studentName").value = "";
      document.getElementById("studentId").value = "";
      document.getElementById("studentMobile").value = "";
      document.getElementById("studentPhoto").value = "";
    }

    function deleteStudent(index) {
      let students = JSON.parse(localStorage.getItem("students")) || [];
      students.splice(index, 1);
      localStorage.setItem("students", JSON.stringify(students));
      loadStudents();
    }

    function uploadResult(index) {
      let students = JSON.parse(localStorage.getItem("students")) || [];
      let result = prompt("Enter result for " + students[index].name);
      if (result !== null) {
        students[index].result = result;
        localStorage.setItem("students", JSON.stringify(students));
        loadStudents();
      }
    }

    // -------- Questions Management --------
    function addQuestion() {
      const question = document.getElementById("questionInput").value;
      const options = [
        document.getElementById("option1").value,
        document.getElementById("option2").value,
        document.getElementById("option3").value,
        document.getElementById("option4").value,
      ];
      const correct = document.getElementById("correctAnswer").value;

      if (!question || options.some(opt => !opt)) {
        alert("Please fill all fields");
        return;
      }

      let questions = JSON.parse(localStorage.getItem("questions")) || [];
      questions.push({ question, options, correct });
      localStorage.setItem("questions", JSON.stringify(questions));

      loadQuestions();

      // clear input
      document.getElementById("questionInput").value = "";
      options.forEach((_, i) => document.getElementById("option" + (i + 1)).value = "");
    }

    function loadQuestions() {
      let questions = JSON.parse(localStorage.getItem("questions")) || [];
      const table = document.getElementById("questionsTable");
      table.innerHTML = `
        <tr>
          <th>Question</th>
          <th>Options</th>
          <th>Correct Answer</th>
          <th>Action</th>
        </tr>`;
      
      questions.forEach((q, index) => {
        let row = table.insertRow();
        row.insertCell(0).innerText = q.question;
        row.insertCell(1).innerText = q.options.join(", ");
        row.insertCell(2).innerText = "Option " + q.correct;
        let actionCell = row.insertCell(3);
        let btn = document.createElement("button");
        btn.innerText = "Delete";
        btn.onclick = function() {
          deleteQuestion(index);
        };
        actionCell.appendChild(btn);
      });
    }

    function deleteQuestion(index) {
      let questions = JSON.parse(localStorage.getItem("questions")) || [];
      questions.splice(index, 1);
      localStorage.setItem("questions", JSON.stringify(questions));
      loadQuestions();
    }

    // -------- Logout --------
    function logout() {
      alert("Logged out!");
      window.location.href = "index.html";
    }

    // -------- On Page Load --------
    window.onload = function () {
      loadStudents();
      loadQuestions();
    };
  </script>
</body>
</html>
